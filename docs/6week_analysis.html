<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Jie Zhou" />


<title>Analysis Based on 6-week Data</title>

<script src="site_libs/header-attrs-2.14/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/main/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>



<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Immunue_Cell_Study</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="license.html">License</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Analysis Based on 6-week Data</h1>
<h4 class="author">Jie Zhou</h4>
<h4 class="date">9/21/2022</h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span> workflowr <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> </a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2022-09-23
</p>
<p>
<strong>Checks:</strong> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 7 <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span> 0
</p>
<p>
<strong>Knit directory:</strong> <code>Immunue_Cell_Study/</code> <span class="glyphicon glyphicon-question-sign" aria-hidden="true" title="This is the local directory in which the code in this file was executed."> </span>
</p>
<p>
This reproducible <a href="https://rmarkdown.rstudio.com">R Markdown</a> analysis was created with <a
  href="https://github.com/workflowr/workflowr">workflowr</a> (version 1.7.0). The <em>Checks</em> tab describes the reproducibility checks that were applied when the results were created. The <em>Past versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguptodate"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>R Markdown file:</strong> up-to-date </a>
</p>
</div>
<div id="strongRMarkdownfilestronguptodate" class="panel-collapse collapse">
<div class="panel-body">
<p>Great! Since the R Markdown file has been committed to the Git repository, you know the exact version of the code that produced these results.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the global environment can affect the analysis in your R Markdown file in unknown ways. For reproduciblity it’s best to always run the code in an empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20220920code"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Seed:</strong> <code>set.seed(20220920)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20220920code" class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20220920)</code> was run prior to running the code in the R Markdown file. Setting a seed ensures that any results that rely on randomness, e.g. subsampling or permutations, are reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Session information:</strong> recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be confident that you successfully produced the results during this run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcomjiezhou2LongitudinalAnalysisofImmuneCelltreeb833ed0b4bb36b1d7902ac70e0cd4586853ccdfdtargetblankb833ed0a"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Repository version:</strong> <a href="https://github.com/jiezhou-2/Longitudinal-Analysis-of-Immune-Cell-/tree/b833ed0b4bb36b1d7902ac70e0cd4586853ccdfd" target="_blank">b833ed0</a> </a>
</p>
</div>
<div id="strongRepositoryversionstrongahrefhttpsgithubcomjiezhou2LongitudinalAnalysisofImmuneCelltreeb833ed0b4bb36b1d7902ac70e0cd4586853ccdfdtargetblankb833ed0a" class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development and connecting the code version to the results is critical for reproducibility.
</p>
<p>
The results in this page were generated with repository version <a href="https://github.com/jiezhou-2/Longitudinal-Analysis-of-Immune-Cell-/tree/b833ed0b4bb36b1d7902ac70e0cd4586853ccdfd" target="_blank">b833ed0</a>. See the <em>Past versions</em> tab to see a history of the changes made to the R Markdown and HTML files.
</p>
<p>
Note that you need to be careful to ensure that all relevant files for the analysis have been committed to Git prior to generating the results (you can use <code>wflow_publish</code> or <code>wflow_git_commit</code>). workflowr only checks the R Markdown file, but you know if there are other scripts or data files that it depends on. Below is the status of the Git repository when the results were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    .Rhistory
    Ignored:    .Rproj.user/
    Ignored:    analysis/.Rhistory

Unstaged changes:
    Modified:   analysis/index.Rmd

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not included in this status report because it is ok for generated content to have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">

<p>
These are the previous versions of the repository in which changes were made to the R Markdown (<code>analysis/6week_analysis.Rmd</code>) and HTML (<code>docs/6week_analysis.html</code>) files. If you’ve configured a remote Git repository (see <code>?wflow_git_remote</code>), click on the hyperlinks in the table below to view the files as they were in that past version.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/jiezhou-2/Longitudinal-Analysis-of-Immune-Cell-/blob/b833ed0b4bb36b1d7902ac70e0cd4586853ccdfd/analysis/6week_analysis.Rmd" target="_blank">b833ed0</a>
</td>
<td>
Jie Zhou
</td>
<td>
2022-09-23
</td>
<td>
use marginal model to handle cross-sectional data
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jiezhou-2/Longitudinal-Analysis-of-Immune-Cell-/b833ed0b4bb36b1d7902ac70e0cd4586853ccdfd/docs/6week_analysis.html" target="_blank">b833ed0</a>
</td>
<td>
Jie Zhou
</td>
<td>
2022-09-23
</td>
<td>
use marginal model to handle cross-sectional data
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/jiezhou-2/Longitudinal-Analysis-of-Immune-Cell-/blob/9600acc30e448e9ba71ee9720ce01627b5e6c996/analysis/6week_analysis.Rmd" target="_blank">9600acc</a>
</td>
<td>
Jie Zhou
</td>
<td>
2022-09-22
</td>
<td>
unify the data reading
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jiezhou-2/Longitudinal-Analysis-of-Immune-Cell-/9600acc30e448e9ba71ee9720ce01627b5e6c996/docs/6week_analysis.html" target="_blank">9600acc</a>
</td>
<td>
Jie Zhou
</td>
<td>
2022-09-22
</td>
<td>
unify the data reading
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/jiezhou-2/Longitudinal-Analysis-of-Immune-Cell-/blob/8caf0a04316786d19c199a9eecaaf62c9277dfd0/analysis/6week_analysis.Rmd" target="_blank">8caf0a0</a>
</td>
<td>
Jie Zhou
</td>
<td>
2022-09-21
</td>
<td>
title changed
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jiezhou-2/Longitudinal-Analysis-of-Immune-Cell-/8caf0a04316786d19c199a9eecaaf62c9277dfd0/docs/6week_analysis.html" target="_blank">8caf0a0</a>
</td>
<td>
Jie Zhou
</td>
<td>
2022-09-21
</td>
<td>
title changed
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/jiezhou-2/Longitudinal-Analysis-of-Immune-Cell-/blob/1c9b2045edc7c1397ff64215d01f73f59039f7a2/analysis/6week_analysis.Rmd" target="_blank">1c9b204</a>
</td>
<td>
Jie Zhou
</td>
<td>
2022-09-21
</td>
<td>
title changed
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jiezhou-2/Longitudinal-Analysis-of-Immune-Cell-/1c9b2045edc7c1397ff64215d01f73f59039f7a2/docs/6week_analysis.html" target="_blank">1c9b204</a>
</td>
<td>
Jie Zhou
</td>
<td>
2022-09-21
</td>
<td>
title changed
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/jiezhou-2/Longitudinal-Analysis-of-Immune-Cell-/blob/e75d82e79742f2519d0ddac306819e2bf5409148/analysis/6week_analysis.Rmd" target="_blank">e75d82e</a>
</td>
<td>
Jie Zhou
</td>
<td>
2022-09-20
</td>
<td>
add the remote repo
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jiezhou-2/Longitudinal-Analysis-of-Immune-Cell-/e75d82e79742f2519d0ddac306819e2bf5409148/docs/6week_analysis.html" target="_blank">e75d82e</a>
</td>
<td>
Jie Zhou
</td>
<td>
2022-09-20
</td>
<td>
add the remote repo
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/jiezhou-2/Longitudinal-Analysis-of-Immune-Cell-/blob/546725fabf878fbf9536c58b8f3608e772d70b4e/analysis/6week_analysis.Rmd" target="_blank">546725f</a>
</td>
<td>
Jie Zhou
</td>
<td>
2022-09-20
</td>
<td>
add the remote repo
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jiezhou-2/Longitudinal-Analysis-of-Immune-Cell-/546725fabf878fbf9536c58b8f3608e772d70b4e/docs/6week_analysis.html" target="_blank">546725f</a>
</td>
<td>
Jie Zhou
</td>
<td>
2022-09-20
</td>
<td>
add the remote repo
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/jiezhou-2/Longitudinal-Analysis-of-Immune-Cell-/blob/5bf2b3b9d81e5b8363391867d535b6eae7985742/analysis/6week_analysis.Rmd" target="_blank">5bf2b3b</a>
</td>
<td>
Jie Zhou
</td>
<td>
2022-09-20
</td>
<td>
add the remote repo
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jiezhou-2/Longitudinal-Analysis-of-Immune-Cell-/5bf2b3b9d81e5b8363391867d535b6eae7985742/docs/6week_analysis.html" target="_blank">5bf2b3b</a>
</td>
<td>
Jie Zhou
</td>
<td>
2022-09-20
</td>
<td>
add the remote repo
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jiezhou-2/Longitudinal-Analysis-of-Immune-Cell-/31c224388ab1c8de24f092634a1a4ecf5307add2/docs/6week_analysis.html" target="_blank">31c2243</a>
</td>
<td>
Jie Zhou
</td>
<td>
2022-09-20
</td>
<td>
add the remote repo
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/jiezhou-2/Longitudinal-Analysis-of-Immune-Cell-/blob/098d05845281e5b861e925cdbf3f6dacefff7497/analysis/6week_analysis.Rmd" target="_blank">098d058</a>
</td>
<td>
Jie Zhou
</td>
<td>
2022-09-20
</td>
<td>
immune cell
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jiezhou-2/Longitudinal-Analysis-of-Immune-Cell-/098d05845281e5b861e925cdbf3f6dacefff7497/docs/6week_analysis.html" target="_blank">098d058</a>
</td>
<td>
Jie Zhou
</td>
<td>
2022-09-20
</td>
<td>
immune cell
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<div id="clean-the-data" class="section level2">
<h2>clean the data</h2>
<pre class="r"><code>source(&quot;./code/datacleaning.r&quot;)
index=which(longidata$time==6)</code></pre>
</div>
<div id="regression-analysis" class="section level2">
<h2>Regression analysis</h2>
<div id="microbes-associated-with-bcell-fdr0.1" class="section level3">
<h3>Microbes associated with Bcell: FDR=0.1</h3>
<details>
<summary>
Click me
</summary>
<pre class="r"><code>options(warn = 2)
m=ncol(longidata)-2
n=nrow(longidata)
name=colnames(longidata)[-c(1,2)]
microbe=c()                            
rrbcell=data.frame()
for (k in 1:m) {
  y1=longidata[index,k+2]
  y2=apply(longidata[index,-c(1,2,k+2)],1,sum)
  #if (length(which(y1&gt;0))&lt;=5){next}
  fm=try({glm(cbind(y1,y2)~bcell + bbymale + enrollment_age + imrbthwghtg_all +gestage_all+evercigpreg+alpha+deliver, data=longibcell[index,],family=&quot;binomial&quot;)},silent = T)
  if (inherits(fm,&quot;try-error&quot;)){
    next()
  }else{
    fm=glm(cbind(y1,y2)~bcell + bbymale + enrollment_age + imrbthwghtg_all +gestage_all+evercigpreg+alpha+deliver ,data=longibcell[index,],family=&quot;binomial&quot;)   
   a=summary(fm)
   r1=a$coefficients[2,1]
   r2=a$coefficients[2,4]
   r3= c(r1-1.96*a$coefficients[2,2],r1+ 1.96*a$coefficients[2,2])
   rr=c(r1,r2,r3)
   microbe=c(microbe,name[k])
    rrbcell=rbind(rrbcell,rr)
     }

}
colnames(rrbcell)=c(&quot;coef&quot;,&quot;pvalue&quot;,&quot;lower&quot;,&quot;upper&quot;)
fdr=p.adjust(rrbcell[,2],method = &quot;BH&quot;)
rrbcell=data.frame(microbe,rrbcell,fdr)
rrbcell=rrbcell[order(rrbcell[,3]),]
rrbcellfdr=rrbcell[which(rrbcell[,6]&lt;0.1),]</code></pre>
<pre><code>                     microbe        coef        pvalue        lower
2                Actinomyces -0.34144625  0.000000e+00 -0.348931638
6                Bacteroides  0.02521323  0.000000e+00  0.024487300
7            Bifidobacterium -0.04045805  0.000000e+00 -0.041313022
8                    Blautia  0.13222197  0.000000e+00  0.130369250
11               Citrobacter -0.31228273  0.000000e+00 -0.318424016
14         Clostridium_XVIII  0.17770835  0.000000e+00  0.176316735
20              Enterobacter  0.16787844  0.000000e+00  0.165979878
21              Enterococcus -0.35742862  0.000000e+00 -0.359498191
24     F__Enterobacteriaceae -0.10599723  0.000000e+00 -0.107889353
25    F__Erysipelotrichaceae  0.40056202  0.000000e+00  0.391126535
31                   Gemella  0.31656157  0.000000e+00  0.300701209
34           Intestinibacter -0.88189347  0.000000e+00 -0.916143031
35                Klebsiella  0.14821964  0.000000e+00  0.145811499
37             Lactobacillus -0.30081828  0.000000e+00 -0.303903400
40           Parabacteroides -0.24899323  0.000000e+00 -0.252227731
43                Raoultella  0.32893057  0.000000e+00  0.318341430
46            Staphylococcus  0.07376760  0.000000e+00  0.070109838
47             Streptococcus  0.14953248  0.000000e+00  0.148366931
44                Romboutsia -0.40857705 2.660370e-295 -0.430381189
49               Varibaculum -1.33743586 3.536215e-211 -1.421959289
50               Veillonella  0.02921007 3.457742e-208  0.027350704
13            Clostridium_XI -0.29489287 4.982304e-196 -0.314243732
16 Clostridium_sensu_stricto -0.02038129 1.560538e-189 -0.021741686
26        F__Lachnospiraceae  0.02882647 1.121700e-178  0.026844123
45                    Rothia  0.22272989 1.876132e-170  0.207043614
17           Corynebacterium -0.28619192 1.790965e-121 -0.310125635
22      Escherichia/Shigella -0.01225394 6.240454e-116 -0.013303343
4               Anaerostipes -0.83029460 1.080759e-102 -0.905927002
1              Acinetobacter -0.35658882  4.717839e-62 -0.398632806
42         Propionibacterium -0.23553227  4.375787e-61 -0.263528709
38               Lactococcus -0.55510541  1.004179e-58 -0.622442611
5                  Atopobium  0.12476066  9.732001e-40  0.106224619
12            Clostridium_IV -0.15368532  3.475926e-39 -0.176686688
19               Eggerthella -0.13202518  9.543765e-29 -0.155286582
41                Prevotella  0.19333556  1.630601e-25  0.157038339
9               Buttiauxella -0.20630904  1.591262e-23 -0.246762926
30             Fusobacterium  0.19232016  3.247494e-21  0.152450278
33               Haemophilus  0.03363840  5.941379e-20  0.026429167
32            Granulicatella -0.43759581  8.244933e-14 -0.552469563
15          Clostridium_XlVa -0.01177915  4.702560e-10 -0.015485709
3               Anaerococcus -0.07586561  3.097120e-06 -0.107745526
48          Terrisporobacter  0.02115181  2.752662e-04  0.009754635
36       Lachnoanaerobaculum -1.21952073  1.973596e-03 -1.992023569
27          Faecalibacterium -0.05810238  1.159112e-02 -0.103215169
51                 Weissella  0.17141959  1.790992e-02  0.029503682
10          Chryseobacterium -0.17089786  2.630202e-02 -0.321663629
39            Negativicoccus  0.03228285  4.299860e-02  0.001016532
28                Finegoldia -0.04305268  5.039679e-02 -0.086180607
           upper           fdr
2  -3.339609e-01  0.000000e+00
6   2.593916e-02  0.000000e+00
7  -3.960308e-02  0.000000e+00
8   1.340747e-01  0.000000e+00
11 -3.061414e-01  0.000000e+00
14  1.791000e-01  0.000000e+00
20  1.697770e-01  0.000000e+00
21 -3.553590e-01  0.000000e+00
24 -1.041051e-01  0.000000e+00
25  4.099975e-01  0.000000e+00
31  3.324219e-01  0.000000e+00
34 -8.476439e-01  0.000000e+00
35  1.506278e-01  0.000000e+00
37 -2.977332e-01  0.000000e+00
40 -2.457587e-01  0.000000e+00
43  3.395197e-01  0.000000e+00
46  7.742537e-02  0.000000e+00
47  1.506980e-01  0.000000e+00
44 -3.867729e-01 7.140992e-295
49 -1.252912e+00 9.017347e-211
50  3.106943e-02 8.397373e-208
13 -2.755420e-01 1.154989e-195
16 -1.902089e-02 3.460323e-189
26  3.080882e-02 2.383612e-178
45  2.384162e-01 3.827309e-170
17 -2.622582e-01 3.513047e-121
22 -1.120455e-02 1.178752e-115
4  -7.546622e-01 1.968526e-102
1  -3.145448e-01  8.296889e-62
42 -2.075358e-01  7.438838e-61
38 -4.877682e-01  1.652036e-58
5   1.432967e-01  1.551038e-39
12 -1.306840e-01  5.371886e-39
19 -1.087638e-01  1.431565e-28
41  2.296328e-01  2.376019e-25
9  -1.658552e-01  2.254289e-23
30  2.321900e-01  4.476276e-21
33  4.084763e-02  7.973956e-20
32 -3.227220e-01  1.078184e-13
15 -8.072589e-03  5.995764e-10
3  -4.398569e-02  3.852515e-06
48  3.254898e-02  3.342518e-04
36 -4.470179e-01  2.340777e-03
27 -1.298958e-02  1.343516e-02
51  3.133355e-01  2.029791e-02
10 -2.013209e-02  2.916094e-02
39  6.354917e-02  4.665805e-02
28  7.523931e-05  5.354659e-02</code></pre>
<p>&lt;&gt;</p>
</div>
<div id="microbes-associated-with-cd4-fdr0.1" class="section level3">
<h3>Microbes associated with CD4: FDR=0.1</h3>
<details>
<summary>
Click me
</summary>
<pre class="r"><code>options(warn = 2)
m=ncol(longidata)-2
n=nrow(longidata)
name=colnames(longidata)[-c(1,2)]
microbe=c()                            
rrbcell=data.frame()
for (k in 1:m) {
  y1=longidata[index,k+2]
  y2=apply(longidata[index,-c(1,2,k+2)],1,sum)
  #if (length(which(y1&gt;0))&lt;=5){next}
  fm=try({glm(cbind(y1,y2)~cd4t + bbymale + enrollment_age + imrbthwghtg_all +gestage_all+evercigpreg+alpha+deliver, data=longicd4[index,],family=&quot;binomial&quot;)},silent = T)
  if (inherits(fm,&quot;try-error&quot;)){
    next()
  }else{
    fm=glm(cbind(y1,y2)~cd4t + bbymale + enrollment_age + imrbthwghtg_all +gestage_all+evercigpreg+alpha+deliver , data=longicd4[index,],family=&quot;binomial&quot;)   
   a=summary(fm)
   r1=a$coefficients[2,1]
   r2=a$coefficients[2,4]
   r3= c(r1-1.96*a$coefficients[2,2],r1+ 1.96*a$coefficients[2,2])
   rr=c(r1,r2,r3)
   microbe=c(microbe,name[k])
    rrbcell=rbind(rrbcell,rr)
     }

}
colnames(rrbcell)=c(&quot;coef&quot;,&quot;pvalue&quot;,&quot;lower&quot;,&quot;upper&quot;)
fdr=p.adjust(rrbcell[,2],method = &quot;BY&quot;)
rrbcell=data.frame(microbe,rrbcell,fdr)
rrbcell=rrbcell[order(rrbcell[,3]),]
rrbcellfdr=rrbcell[which(rrbcell[,6]&lt;0.1),]</code></pre>
<pre><code>                     microbe         coef        pvalue        lower
8            Bifidobacterium -0.090918188  0.000000e+00 -0.091431546
9                    Blautia -0.196081646  0.000000e+00 -0.197611626
14         Clostridium_XVIII  0.137182454  0.000000e+00  0.135967576
16 Clostridium_sensu_stricto -0.135792834  0.000000e+00 -0.136860864
20              Enterobacter -0.179098524  0.000000e+00 -0.181760098
21              Enterococcus  0.015714683  0.000000e+00  0.014910465
22      Escherichia/Shigella  0.055831479  0.000000e+00  0.055190833
23     F__Enterobacteriaceae -0.069093747  0.000000e+00 -0.070189278
24    F__Erysipelotrichaceae -0.320615973  0.000000e+00 -0.327761776
25        F__Lachnospiraceae -0.082472288  0.000000e+00 -0.083972674
30               Haemophilus -0.175315059  0.000000e+00 -0.180241616
33             Lactobacillus  0.067574861  0.000000e+00  0.066105798
36           Parabacteroides  0.126520656  0.000000e+00  0.124210891
39               Pseudomonas -0.635328006  0.000000e+00 -0.642560489
45               Veillonella -0.140964052  0.000000e+00 -0.142426932
17           Corynebacterium -0.262582653 4.768488e-303 -0.276414073
43             Streptococcus -0.016071914 8.953322e-286 -0.016943896
31           Intestinibacter -0.186372601 6.568311e-218 -0.197965856
15          Clostridium_XlVa -0.025693188 3.046364e-191 -0.027400372
13            Clostridium_XI -0.068615102 1.636280e-124 -0.074281649
44               Varibaculum -0.269836771 1.786160e-122 -0.292308791
5               Anaerostipes  0.444183990 3.654335e-114  0.405846663
7                Bacteroides  0.005703242 1.080709e-104  0.005188809
1              Acinetobacter  0.176443013  6.925412e-94  0.159618579
12            Clostridium_IV -0.099539482  7.324775e-48 -0.112962538
10              Buttiauxella -0.164355219  6.962892e-45 -0.187271393
42            Staphylococcus  0.019020204  1.096377e-43  0.016330609
2                Actinomyces  0.028855488  1.462876e-37  0.024440044
34               Lactococcus -0.133429019  1.749052e-23 -0.159616856
40                Raoultella -0.029360146  8.871501e-23 -0.035217806
26          Faecalibacterium -0.112214316  1.078320e-18 -0.137131968
32                Klebsiella  0.008444617  5.402173e-17  0.006468936
37                Prevotella -0.104496816  1.407059e-14 -0.131110819
38         Propionibacterium -0.045742737  6.869898e-11 -0.059486306
6                  Atopobium -0.055532452  7.480620e-10 -0.073214574
28                   Gemella -0.042139809  1.244329e-06 -0.059174966
41                    Rothia -0.037655778  1.635575e-06 -0.053051405
3               Anaerococcus  0.049983239  3.543648e-06  0.028853674
27                Finegoldia  0.069679334  6.374463e-06  0.039421374
11          Chryseobacterium -0.160693485  1.630617e-04 -0.244230747
35            Negativicoccus  0.044200246  4.807012e-04  0.019386330
4          Anaerosporobacter -0.151982987  1.794837e-02 -0.277849800
          upper           fdr
8  -0.090404830  0.000000e+00
9  -0.194551666  0.000000e+00
14  0.138397333  0.000000e+00
16 -0.134724803  0.000000e+00
20 -0.176436950  0.000000e+00
21  0.016518901  0.000000e+00
22  0.056472125  0.000000e+00
23 -0.067998216  0.000000e+00
24 -0.313470169  0.000000e+00
25 -0.080971903  0.000000e+00
30 -0.170388502  0.000000e+00
33  0.069043925  0.000000e+00
36  0.128830420  0.000000e+00
39 -0.628095522  0.000000e+00
45 -0.139501172  0.000000e+00
17 -0.248751232 5.894229e-302
43 -0.015199933 1.041601e-284
31 -0.174779345 7.216846e-217
15 -0.023986005 3.170987e-190
13 -0.062948555 1.618058e-123
44 -0.247364750 1.682160e-121
5   0.482521318 3.285126e-113
7   0.006217675 9.292816e-104
1   0.193267446  5.706905e-93
12 -0.086116426  5.794561e-47
10 -0.141439045  5.296422e-44
42  0.021709799  8.030870e-43
2   0.033270932  1.033275e-36
34 -0.107241183  1.192809e-22
40 -0.023502486  5.848468e-22
26 -0.087296663  6.879427e-18
32  0.010420298  3.338757e-16
37 -0.077882814  8.432658e-14
38 -0.031999168  3.996112e-10
6  -0.037850330  4.227035e-09
28 -0.025104652  6.835952e-06
41 -0.022260152  8.742490e-06
3   0.071112805  1.844307e-05
27  0.099937293  3.232550e-05
11 -0.077156223  8.062285e-04
35  0.069014163  2.318770e-03
4  -0.026116174  8.451661e-02</code></pre>
<p>&lt;&gt;</p>
</div>
<div id="microbes-associated-with-cd8-fdr0.1" class="section level3">
<h3>Microbes associated with CD8: FDR=0.1</h3>
<details>
<summary>
Click me
</summary>
<pre class="r"><code>options(warn = 2)
m=ncol(longidata)-2
n=nrow(longidata)
name=colnames(longidata)[-c(1,2)]
microbe=c()                            
rrbcell=data.frame()
for (k in 1:m) {
  y1=longidata[index,k+2]
  y2=apply(longidata[index,-c(1,2,k+2)],1,sum)
  #if (length(which(y1&gt;0))&lt;=5){next}
  fm=try({glm(cbind(y1,y2)~cd8t + bbymale + enrollment_age + imrbthwghtg_all +gestage_all+evercigpreg+alpha+deliver , data=longicd8[index,],family=&quot;binomial&quot;)},silent = T)
  if (inherits(fm,&quot;try-error&quot;)){
    next()
  }else{
    fm=glm(cbind(y1,y2)~cd8t + bbymale + enrollment_age + imrbthwghtg_all +gestage_all+evercigpreg+alpha+deliver , data=longicd8[index,],family=&quot;binomial&quot;)   
   a=summary(fm)
   r1=a$coefficients[2,1]
   r2=a$coefficients[2,4]
   r3= c(r1-1.96*a$coefficients[2,2],r1+ 1.96*a$coefficients[2,2])
   rr=c(r1,r2,r3)
   microbe=c(microbe,name[k])
    rrbcell=rbind(rrbcell,rr)
     }

}
colnames(rrbcell)=c(&quot;coef&quot;,&quot;pvalue&quot;,&quot;lower&quot;,&quot;upper&quot;)
fdr=p.adjust(rrbcell[,2],method = &quot;BY&quot;)
rrbcell=data.frame(microbe,rrbcell,fdr)
rrbcell=rrbcell[order(rrbcell[,3]),]
rrbcellfdr=rrbcell[which(rrbcell[,6]&lt;0.1),]</code></pre>
<pre><code>                     microbe         coef        pvalue        lower
1              Acinetobacter  0.618139024  0.000000e+00  0.600559331
7                Bacteroides -0.055116837  0.000000e+00 -0.055994411
8            Bifidobacterium -0.040736977  0.000000e+00 -0.041655889
9                    Blautia -0.338149577  0.000000e+00 -0.340925778
14            Clostridium_XI  0.271347841  0.000000e+00  0.260799417
15         Clostridium_XVIII  0.237850086  0.000000e+00  0.236272026
21              Enterobacter  0.262403806  0.000000e+00  0.259903848
22              Enterococcus -0.057689379  0.000000e+00 -0.059117003
23      Escherichia/Shigella  0.035333097  0.000000e+00  0.034289903
25    F__Erysipelotrichaceae  0.305964333  0.000000e+00  0.292775064
26        F__Lachnospiraceae  0.088609586  0.000000e+00  0.086162723
33               Haemophilus  0.182142062  0.000000e+00  0.173338900
35                Klebsiella -0.093635689  0.000000e+00 -0.097489097
36             Lactobacillus -0.156798118  0.000000e+00 -0.159726183
39           Parabacteroides -0.083569740  0.000000e+00 -0.086715450
42                Raoultella  0.408139861  0.000000e+00  0.394968707
43                Romboutsia  0.389277583  0.000000e+00  0.374233374
45            Staphylococcus  0.106341284  0.000000e+00  0.102739334
46             Streptococcus  0.146847625  0.000000e+00  0.145451962
48               Veillonella  0.062549925  0.000000e+00  0.060400072
31                   Gemella  0.475388483 6.364785e-304  0.450383930
16          Clostridium_XlVa -0.052977336 2.221398e-199 -0.056424061
13            Clostridium_IV -0.526030920 4.606198e-193 -0.560816060
38            Negativicoccus  0.577367197 1.092186e-152  0.534373998
6                  Atopobium  0.284109408 2.378025e-144  0.262342554
44                    Rothia  0.267794018 1.233621e-134  0.246538999
24     F__Enterobacteriaceae  0.021974530 1.123863e-130  0.020203763
2                Actinomyces -0.077044982 3.120652e-108 -0.083877753
5               Anaerostipes  0.408967130  4.274362e-92  0.369585509
20               Eggerthella -0.194377752  1.784306e-59 -0.217802857
3               Anaerococcus -0.266739855  2.222648e-44 -0.304150884
30             Fusobacterium  0.512655625  1.938680e-40  0.437181552
10              Buttiauxella -0.251003394  7.482938e-40 -0.288239798
12               Citrobacter -0.027311721  6.672667e-36 -0.031591146
17 Clostridium_sensu_stricto -0.007931711  1.929997e-25 -0.009423114
37               Lactococcus -0.213635867  4.099873e-21 -0.258039381
18           Corynebacterium -0.081659054  4.892338e-13 -0.103801565
41         Propionibacterium -0.094335340  1.420061e-10 -0.123163714
28                Finegoldia -0.160577717  1.186921e-09 -0.212325874
47               Varibaculum  0.072329805  9.995512e-08  0.045716027
27          Faecalibacterium -0.088987317  9.161475e-05 -0.133574364
4          Anaerosporobacter -0.307276813  1.074628e-04 -0.462775938
34           Intestinibacter  0.024598841  1.043331e-03  0.009893139
49                 Weissella  0.346532861  1.221248e-03  0.136504543
          upper           fdr
1   0.635718718  0.000000e+00
7  -0.054239263  0.000000e+00
8  -0.039818064  0.000000e+00
9  -0.335373376  0.000000e+00
14  0.281896264  0.000000e+00
15  0.239428146  0.000000e+00
21  0.264903764  0.000000e+00
22 -0.056261754  0.000000e+00
23  0.036376291  0.000000e+00
25  0.319153601  0.000000e+00
26  0.091056449  0.000000e+00
33  0.190945225  0.000000e+00
35 -0.089782281  0.000000e+00
36 -0.153870053  0.000000e+00
39 -0.080424031  0.000000e+00
42  0.421311015  0.000000e+00
43  0.404321793  0.000000e+00
45  0.109943233  0.000000e+00
46  0.148243288  0.000000e+00
48  0.064699779  0.000000e+00
31  0.500393037 6.652142e-303
16 -0.049530612 2.216158e-198
13 -0.491245780 4.395536e-192
38  0.620360396 9.988086e-152
6   0.305876261 2.087726e-143
44  0.289049036 1.041371e-133
24  0.023745296 9.135800e-130
2  -0.070212211 2.446157e-107
5   0.448348751  3.234970e-91
20 -0.170952646  1.305405e-58
3  -0.229328826  1.573643e-43
30  0.588129698  1.329699e-39
10 -0.213766989  4.976858e-39
12 -0.023032297  4.307424e-35
17 -0.006440307  1.210280e-24
37 -0.169232352  2.499568e-20
18 -0.059516544  2.902096e-12
41 -0.065506966  8.202015e-10
28 -0.108829560  6.679656e-09
47  0.098943583  5.484564e-07
27 -0.044400270  4.904318e-04
4  -0.151777688  5.615729e-04
34  0.039304544  5.325383e-03
49  0.556561179  6.091835e-03</code></pre>
<p>&lt;&gt;</p>
</div>
<div id="microbes-associated-with-mono-fdr0.1" class="section level3">
<h3>Microbes associated with Mono: FDR=0.1</h3>
<details>
<summary>
Click me
</summary>
<pre class="r"><code>options(warn = 2)
m=ncol(longidata)-2
n=nrow(longidata)
name=colnames(longidata)[-c(1,2)]
microbe=c()                            
rrbcell=data.frame()
for (k in 1:m) {
  y1=longidata[index,k+2]
  y2=apply(longidata[index,-c(1,2,k+2)],1,sum)
#  if (length(which(y1&gt;0))&lt;=5) {next}
  fm=try({glm(cbind(y1,y2)~mono + bbymale + enrollment_age + imrbthwghtg_all +gestage_all+evercigpreg+alpha+deliver , data=longimono[index,],family=&quot;binomial&quot;)},silent = T)
  if (inherits(fm,&quot;try-error&quot;)){
    next()
  }else{
    fm=glm(cbind(y1,y2)~mono + bbymale + enrollment_age + imrbthwghtg_all +gestage_all+evercigpreg+alpha+deliver , data=longimono[index,],family=&quot;binomial&quot;)
   a=summary(fm)
   r1=a$coefficients[2,1]
   r2=a$coefficients[2,4]
   r3= c(r1-1.96*a$coefficients[2,2],r1+ 1.96*a$coefficients[2,2])
   rr=c(r1,r2,r3)
   microbe=c(microbe,name[k])
    rrbcell=rbind(rrbcell,rr)
     }

}
colnames(rrbcell)=c(&quot;coef&quot;,&quot;pvalue&quot;,&quot;lower&quot;,&quot;upper&quot;)
fdr=p.adjust(rrbcell[,2],method = &quot;BH&quot;)
rrbcell=data.frame(microbe,rrbcell,fdr)
rrbcell=rrbcell[order(rrbcell[,3]),]
rrbcellfdr=rrbcell[which(rrbcell[,6]&lt;0.1),]</code></pre>
<pre><code>                     microbe         coef        pvalue       lower
1                Actinomyces -0.592813608  0.000000e+00 -0.60346339
6                Bacteroides  0.043428412  0.000000e+00  0.04249312
7            Bifidobacterium -0.176807070  0.000000e+00 -0.17785695
11               Citrobacter  0.106603559  0.000000e+00  0.10174602
14         Clostridium_XVIII  0.243825011  0.000000e+00  0.24192901
15          Clostridium_XlVa  0.131441935  0.000000e+00  0.12798814
16 Clostridium_sensu_stricto  0.053454622  0.000000e+00  0.05162849
20              Enterobacter -0.184762273  0.000000e+00 -0.18899373
21              Enterococcus -0.160696126  0.000000e+00 -0.16254621
22      Escherichia/Shigella  0.036508503  0.000000e+00  0.03537755
24    F__Erysipelotrichaceae -0.574651061  0.000000e+00 -0.58745145
25        F__Lachnospiraceae -0.407407675  0.000000e+00 -0.41116700
31               Haemophilus  0.277942525  0.000000e+00  0.26810885
33                Klebsiella  0.194675985  0.000000e+00  0.19078729
35             Lactobacillus -0.078151131  0.000000e+00 -0.08126807
38           Parabacteroides -0.174669411  0.000000e+00 -0.17866429
41                Romboutsia  0.771589285  0.000000e+00  0.75169875
43             Ruminococcus2  0.321772839  0.000000e+00  0.30567753
44            Staphylococcus  0.099712710  0.000000e+00  0.09522824
47               Veillonella -0.075218369  0.000000e+00 -0.07790735
45             Streptococcus  0.033219523 6.221763e-305  0.03147515
32           Intestinibacter -0.379888355 2.039874e-228 -0.40296407
23     F__Enterobacteriaceae  0.031108915 1.952919e-204  0.02911040
29                   Gemella -0.549532117 1.337337e-169 -0.58833260
12            Clostridium_IV  0.217368525 6.542925e-130  0.19980008
4               Anaerostipes -0.532614759 1.129089e-103 -0.58089670
40         Propionibacterium  0.240321581  2.803970e-79  0.21533652
42                    Rothia -0.284579084  9.710402e-68 -0.31665233
28             Fusobacterium  0.643673516  3.892558e-54  0.56224106
19               Eggerthella -0.153522043  1.163418e-33 -0.17840642
46               Varibaculum -0.190924804  1.096007e-25 -0.22664063
26          Faecalibacterium  0.157983109  2.622333e-13  0.11563819
39                Prevotella  0.176110990  6.258787e-12  0.12589335
3          Anaerosporobacter -0.783074165  1.935495e-09 -1.03874502
27                Finegoldia  0.124567313  1.145117e-08  0.08179144
36               Lactococcus  0.098297658  4.184769e-06  0.05643240
37            Negativicoccus -0.090748966  2.305249e-05 -0.13276766
13            Clostridium_XI  0.031784664  2.666902e-05  0.01695249
48                 Weissella  0.514078543  9.721851e-05  0.25555082
9               Buttiauxella  0.063281734  8.802510e-04  0.02599276
18            Dolosigranulum -0.192254500  1.002732e-03 -0.30679748
2               Anaerococcus -0.046232260  5.905273e-03 -0.07914740
5                  Atopobium  0.040948114  6.990341e-03  0.01119311
17           Corynebacterium -0.024261119  5.174509e-02 -0.04870622
8                    Blautia -0.002423507  5.267185e-02 -0.00487503
           upper           fdr
1  -0.5821638225  0.000000e+00
6   0.0443637088  0.000000e+00
7  -0.1757571879  0.000000e+00
11  0.1114610951  0.000000e+00
14  0.2457210112  0.000000e+00
15  0.1348957303  0.000000e+00
16  0.0552807561  0.000000e+00
20 -0.1805308187  0.000000e+00
21 -0.1588460400  0.000000e+00
22  0.0376394517  0.000000e+00
24 -0.5618506710  0.000000e+00
25 -0.4036483538  0.000000e+00
31  0.2877761958  0.000000e+00
33  0.1985646809  0.000000e+00
35 -0.0750341917  0.000000e+00
38 -0.1706745327  0.000000e+00
41  0.7914798252  0.000000e+00
43  0.3378681506  0.000000e+00
44  0.1041971782  0.000000e+00
47 -0.0725293903  0.000000e+00
45  0.0349638918 1.422117e-304
32 -0.3568126435 4.450633e-228
23  0.0331074261 4.075657e-204
29 -0.5107316315 2.674673e-169
12  0.2349369665 1.256242e-129
4  -0.4843328170 2.084472e-103
40  0.2653066415  4.984835e-79
42 -0.2525058389  1.664640e-67
28  0.7251059734  6.442854e-54
19 -0.1286376670  1.861470e-33
46 -0.1552089790  1.697044e-25
26  0.2003280302  3.933499e-13
39  0.2263286306  9.103690e-12
3  -0.5274033144  2.732463e-09
27  0.1673431848  1.570446e-08
36  0.1401629135  5.579692e-06
37 -0.0487302740  2.990593e-05
13  0.0466168340  3.368718e-05
48  0.7726062617  1.196535e-04
9   0.1005707093  1.056301e-03
18 -0.0777115201  1.173930e-03
2  -0.0133171194  6.748884e-03
5   0.0707031225  7.803172e-03
17  0.0001839819  5.618330e-02
8   0.0000280154  5.618330e-02</code></pre>
</details>
</div>
<div id="microbes-associated-with-nk-fdr0.1" class="section level3">
<h3>Microbes associated with NK: FDR=0.1</h3>
<details>
<summary>
Click me
</summary>
<pre class="r"><code>options(warn = 2)
m=ncol(longidata)-2
n=nrow(longidata)
name=colnames(longidata)[-c(1,2)]
microbe=c()                            
rrbcell=data.frame()
for (k in 1:m) {
  y1=longidata[index,k+2]
  y2=apply(longidata[index,-c(1,2,k+2)],1,sum)
   #if (length(which(y1&gt;0))&lt;=5) {next}
  fm=try({glm(cbind(y1,y2)~nk + bbymale + enrollment_age + imrbthwghtg_all +gestage_all+evercigpreg+alpha+deliver , data=longink[index,],family=&quot;binomial&quot;)},silent = T)
  if (inherits(fm,&quot;try-error&quot;)){
    next()
  }else{
    fm=glm(cbind(y1,y2)~nk + bbymale + enrollment_age + imrbthwghtg_all +gestage_all+evercigpreg+alpha+deliver,  data=longink[index,],family=&quot;binomial&quot;)  
   a=summary(fm)
   r1=a$coefficients[2,1]
   r2=a$coefficients[2,4]
   r3= c(r1-1.96*a$coefficients[2,2],r1+ 1.96*a$coefficients[2,2])
   rr=c(r1,r2,r3)
   microbe=c(microbe,name[k])
    rrbcell=rbind(rrbcell,rr)
     }
}
colnames(rrbcell)=c(&quot;coef&quot;,&quot;pvalue&quot;,&quot;lower&quot;,&quot;upper&quot;)
fdr=p.adjust(rrbcell[,2],method = &quot;BH&quot;)
rrbcell=data.frame(microbe,rrbcell,fdr)
rrbcell=rrbcell[order(rrbcell[,3]),]
rrbcellfdr=rrbcell[which(rrbcell[,6]&lt;0.1),]</code></pre>
<pre><code>                     microbe        coef        pvalue        lower
2                Actinomyces  0.10784266  0.000000e+00  0.103898462
7                Bacteroides -0.06568714  0.000000e+00 -0.066417182
8            Bifidobacterium -0.18344675  0.000000e+00 -0.184346651
14          Clostridium_XlVa -0.19408955  0.000000e+00 -0.197411318
15 Clostridium_sensu_stricto  0.07366859  0.000000e+00  0.072618585
16           Corynebacterium -0.82365026  0.000000e+00 -0.859503966
19              Enterobacter -0.06756688  0.000000e+00 -0.069965697
20              Enterococcus  0.02816841  0.000000e+00  0.027082461
21      Escherichia/Shigella -0.13991086  0.000000e+00 -0.141003043
22     F__Enterobacteriaceae  0.26550851  0.000000e+00  0.264182935
23    F__Erysipelotrichaceae  0.22814064  0.000000e+00  0.222342553
33             Lactobacillus -0.19257079  0.000000e+00 -0.195100351
36           Parabacteroides  0.05602170  0.000000e+00  0.053420761
42            Staphylococcus -0.09077586  0.000000e+00 -0.094705115
43             Streptococcus  0.11723465  0.000000e+00  0.116137463
44          Terrisporobacter  0.18230703  0.000000e+00  0.176223994
46               Veillonella  0.06536742  0.000000e+00  0.063642937
38         Propionibacterium -0.71958476 7.334505e-210 -0.765205054
1              Acinetobacter -0.50644054 3.449519e-197 -0.539574253
13         Clostridium_XVIII  0.02189419 7.054038e-171  0.020354181
30               Haemophilus -0.09845382 1.965803e-140 -0.106102785
12            Clostridium_XI  0.10636601 3.667387e-115  0.097226184
24        F__Lachnospiraceae  0.02406540 8.078137e-114  0.021985129
32                Klebsiella -0.02402994  3.776801e-61 -0.026884707
11            Clostridium_IV  0.11062854  4.217319e-28  0.090900590
18               Eggerthella  0.07750253  7.536862e-25  0.062745191
39                Raoultella  0.04011859  1.834332e-23  0.032240869
29            Granulicatella  0.32401160  1.763453e-22  0.258907480
3               Anaerococcus  0.09112504  1.008559e-15  0.068871206
5              Anaerotruncus -0.41369393  8.372112e-15 -0.518159174
6                  Atopobium -0.07804846  1.168621e-12 -0.099566866
9               Buttiauxella -0.08168416  3.145970e-10 -0.107131716
27             Fusobacterium  0.12677482  4.551002e-09  0.084392643
26                Finegoldia -0.10416373  3.378428e-08 -0.141145375
31           Intestinibacter -0.03951684  9.193849e-08 -0.054015781
40                Romboutsia  0.02200140  2.610349e-07  0.013627410
47                 Weissella  0.33372555  6.713728e-05  0.169634302
25          Faecalibacterium -0.07286169  2.352893e-04 -0.111692075
4               Anaerostipes -0.07452608  7.428870e-04 -0.117828975
41                    Rothia -0.02870778  4.373695e-03 -0.048451574
17            Dolosigranulum -0.09372324  1.551662e-02 -0.169628464
10          Chryseobacterium  0.07899173  3.146204e-02  0.007020147
28                   Gemella -0.01895419  4.584190e-02 -0.037558627
           upper           fdr
2   0.1117868560  0.000000e+00
7  -0.0649570995  0.000000e+00
8  -0.1825468413  0.000000e+00
14 -0.1907677773  0.000000e+00
15  0.0747185918  0.000000e+00
16 -0.7877965478  0.000000e+00
19 -0.0651680732  0.000000e+00
20  0.0292543566  0.000000e+00
21 -0.1388186727  0.000000e+00
22  0.2668340796  0.000000e+00
23  0.2339387286  0.000000e+00
33 -0.1900412331  0.000000e+00
36  0.0586226488  0.000000e+00
42 -0.0868466059  0.000000e+00
43  0.1183318466  0.000000e+00
44  0.1883900637  0.000000e+00
46  0.0670918999  0.000000e+00
38 -0.6739644680 1.915121e-209
1  -0.4733068349 8.533021e-197
13  0.0234341981 1.657699e-170
30 -0.0908048569 4.399653e-140
12  0.1155058372 7.834872e-115
24  0.0261456698 1.650750e-113
32 -0.0211751706  7.396235e-61
11  0.1303564833  7.928560e-28
18  0.0922598626  1.362433e-24
39  0.0479963019  3.193097e-23
29  0.3891157194  2.960083e-22
3   0.1133788649  1.634562e-15
5  -0.3092286876  1.311631e-14
6  -0.0565300527  1.771780e-12
9  -0.0562366119  4.620644e-10
27  0.1691570049  6.481730e-09
26 -0.0671820805  4.670179e-08
31 -0.0250178987  1.234603e-07
40  0.0303753882  3.407955e-07
47  0.4978168052  8.528249e-05
25 -0.0340313071  2.910157e-04
4  -0.0312231913  8.952740e-04
41 -0.0089639939  5.139092e-03
17 -0.0178180171  1.778735e-02
10  0.1509633200  3.520752e-02
28 -0.0003497456  5.010626e-02</code></pre>
<p>&lt;&gt;</p>
</div>
<div id="microbes-associated-with-nrbc-fdr0.1" class="section level3">
<h3>Microbes associated with NRBC: FDR=0.1</h3>
<details>
<summary>
Click me
</summary>
<pre class="r"><code>options(warn = 2)
m=ncol(longidata)-2
n=nrow(longidata)
name=colnames(longidata)[-c(1,2)]
microbe=c()                            
rrbcell=data.frame()
for (k in 1:m) {
  y1=longidata[index,k+2]
  y2=apply(longidata[index,-c(1,2,k+2)],1,sum)
   if (length(which(y1&gt;0))&lt;=5) {next}
  fm=try({glm(cbind(y1,y2)~nrbc + bbymale + enrollment_age + imrbthwghtg_all +gestage_all+evercigpreg+alpha+deliver , data=longinrbc[index,],family=&quot;binomial&quot;)},silent = T)
  if (inherits(fm,&quot;try-error&quot;)){
    next()
  }else{
    fm=glm(cbind(y1,y2)~nrbc + bbymale + enrollment_age + imrbthwghtg_all +gestage_all+evercigpreg+alpha+deliver , data=longinrbc[index,],family=&quot;binomial&quot;)   
   a=summary(fm)
   r1=a$coefficients[2,1]
   r2=a$coefficients[2,4]
   r3= c(r1-1.96*a$coefficients[2,2],r1+ 1.96*a$coefficients[2,2])
   rr=c(r1,r2,r3)
   microbe=c(microbe,name[k])
    rrbcell=rbind(rrbcell,rr)
     }

}
colnames(rrbcell)=c(&quot;coef&quot;,&quot;pvalue&quot;,&quot;lower&quot;,&quot;upper&quot;)
fdr=round(p.adjust(rrbcell[,2],method = &quot;BH&quot;),3)
rrbcell=data.frame(microbe,rrbcell,fdr)
rrbcell=rrbcell[order(rrbcell[,3]),]
rrbcellfdr=rrbcell[which(rrbcell[,6]&lt;0.1),]</code></pre>
<pre><code>                     microbe         coef        pvalue        lower
1              Acinetobacter -0.341264407  0.000000e+00 -0.353971704
2                Actinomyces  0.093471034  0.000000e+00  0.091363919
6                Bacteroides -0.031958952  0.000000e+00 -0.032376000
7            Bifidobacterium  0.024012797  0.000000e+00  0.023694804
12            Clostridium_XI -0.128664565  0.000000e+00 -0.135282469
13         Clostridium_XVIII  0.033996343  0.000000e+00  0.033302073
14          Clostridium_XlVa -0.041476034  0.000000e+00 -0.042400025
19              Enterobacter  0.044494710  0.000000e+00  0.043282311
21      Escherichia/Shigella -0.017471113  0.000000e+00 -0.017883308
22     F__Enterobacteriaceae  0.040391249  0.000000e+00  0.039797178
23    F__Erysipelotrichaceae  0.154590355  0.000000e+00  0.151119890
24        F__Lachnospiraceae  0.121007383  0.000000e+00  0.120116816
27            Flavonifractor  0.102782608  0.000000e+00  0.100950983
29               Haemophilus -0.175327651  0.000000e+00 -0.181999642
35           Parabacteroides  0.106644232  0.000000e+00  0.105184169
40            Staphylococcus -0.104415611  0.000000e+00 -0.106590587
41             Streptococcus -0.009360334 2.462089e-274 -0.009878742
32             Lactobacillus  0.012179016 4.051566e-213  0.011412873
10               Citrobacter  0.026502245 1.420982e-211  0.024828937
30           Intestinibacter  0.087579802 2.853883e-181  0.081600847
31                Klebsiella -0.025835433 2.707129e-171 -0.027650430
8                    Blautia -0.012591039 3.937935e-167 -0.013486670
4               Anaerostipes  0.203206503 2.342309e-137  0.187240818
16           Corynebacterium -0.170856896 8.684623e-126 -0.184894182
20              Enterococcus  0.003885366  2.393369e-79  0.003481603
3               Anaerococcus -0.152885592  2.034103e-77 -0.168974930
37         Propionibacterium -0.120115834  3.599571e-71 -0.133314088
28                   Gemella  0.084821002  3.053271e-70  0.075437860
34            Negativicoccus -0.179557507  1.912931e-59 -0.201202251
18               Eggerthella  0.069043389  4.225612e-59  0.060695592
11            Clostridium_IV -0.027289711  5.932358e-35 -0.031626281
43               Veillonella  0.004384751  3.539929e-25  0.003555685
15 Clostridium_sensu_stricto  0.002656663  2.685057e-23  0.002133012
25          Faecalibacterium  0.064272381  5.533227e-18  0.049695116
26                Finegoldia -0.081963168  1.039043e-17 -0.100709556
42               Varibaculum  0.034902026  1.652257e-10  0.024197575
39             Ruminococcus2 -0.022743599  3.784366e-10 -0.029861560
33               Lactococcus -0.048612859  1.119969e-09 -0.064255035
36                Prevotella  0.061617498  1.137242e-09  0.041782835
5                  Atopobium -0.030181500  4.347642e-07 -0.041888391
38                    Rothia  0.015415764  8.819359e-04  0.006330517
17            Dolosigranulum -0.060788659  9.391239e-03 -0.106658530
          upper   fdr
1  -0.328557111 0.000
2   0.095578149 0.000
6  -0.031541905 0.000
7   0.024330789 0.000
12 -0.122046662 0.000
13  0.034690612 0.000
14 -0.040552043 0.000
19  0.045707109 0.000
21 -0.017058918 0.000
22  0.040985320 0.000
23  0.158060821 0.000
24  0.121897950 0.000
27  0.104614234 0.000
29 -0.168655659 0.000
35  0.108104295 0.000
40 -0.102240636 0.000
41 -0.008841927 0.000
32  0.012945159 0.000
10  0.028175553 0.000
30  0.093558757 0.000
31 -0.024020437 0.000
8  -0.011695407 0.000
4   0.219172189 0.000
16 -0.156819609 0.000
20  0.004289129 0.000
3  -0.136796254 0.000
37 -0.106917580 0.000
28  0.094204144 0.000
34 -0.157912763 0.000
18  0.077391187 0.000
11 -0.022953141 0.000
43  0.005213818 0.000
15  0.003180314 0.000
25  0.078849646 0.000
26 -0.063216781 0.000
42  0.045606478 0.000
39 -0.015625638 0.000
33 -0.032970682 0.000
36  0.081452160 0.000
5  -0.018474609 0.000
38  0.024501011 0.001
17 -0.014918788 0.010</code></pre>
<p>&lt;&gt;</p>
</div>
<div id="microbes-associated-with-gran-fdr0.1" class="section level3">
<h3>Microbes associated with Gran: FDR=0.1</h3>
<details>
<summary>
Click me
</summary>
<pre class="r"><code>options(warn = 2)
m=ncol(longidata)-2
n=nrow(longidata)
name=colnames(longidata)[-c(1,2)]
microbe=c()                            
rrbcell=data.frame()
for (k in 1:m) {
  y1=longidata[index,k+2]
  y2=apply(longidata[index,-c(1,2,k+2)],1,sum)
   #if (length(which(y1&gt;0))&lt;=5) {next}
  fm=try({glm(cbind(y1,y2)~gran + bbymale + enrollment_age + imrbthwghtg_all +gestage_all+evercigpreg+alpha+deliver , data=longigran[index,],family=&quot;binomial&quot;)},silent = T)
  if (inherits(fm,&quot;try-error&quot;)){
    next()
  }else{
    fm=glm(cbind(y1,y2)~gran + bbymale + enrollment_age + imrbthwghtg_all +gestage_all+evercigpreg+alpha+deliver , data=longigran[index,],family=&quot;binomial&quot;)   
   a=summary(fm)
   r1=a$coefficients[2,1]
   r2=a$coefficients[2,4]
   r3= c(r1-1.96*a$coefficients[2,2],r1+ 1.96*a$coefficients[2,2])
   rr=round(c(r1,r2,r3),3)
   microbe=c(microbe,name[k])
    rrbcell=rbind(rrbcell,rr)
     }

}
colnames(rrbcell)=c(&quot;coef&quot;,&quot;pvalue&quot;,&quot;lower&quot;,&quot;upper&quot;)
fdr=round(p.adjust(rrbcell[,2],method = &quot;BH&quot;),3)
rrbcell=data.frame(microbe,rrbcell,fdr)
rrbcell=rrbcell[order(rrbcell[,3]),]
rrbcellfdr=rrbcell[which(rrbcell[,6]&lt;0.1),]</code></pre>
<pre><code>                     microbe   coef pvalue  lower  upper   fdr
1              Acinetobacter -0.099  0.000 -0.109 -0.090 0.000
2                Actinomyces -0.029  0.000 -0.031 -0.028 0.000
3               Anaerococcus  0.075  0.000  0.065  0.085 0.000
5               Anaerostipes -0.152  0.000 -0.164 -0.140 0.000
6                  Atopobium -0.015  0.000 -0.021 -0.008 0.000
7                Bacteroides  0.012  0.000  0.012  0.012 0.000
8            Bifidobacterium  0.050  0.000  0.050  0.050 0.000
9                    Blautia  0.029  0.000  0.028  0.030 0.000
10              Buttiauxella  0.071  0.000  0.061  0.081 0.000
11          Chryseobacterium -0.053  0.000 -0.078 -0.027 0.000
12               Citrobacter  0.013  0.000  0.012  0.014 0.000
13            Clostridium_IV  0.115  0.000  0.107  0.122 0.000
14            Clostridium_XI  0.100  0.000  0.095  0.105 0.000
15         Clostridium_XVIII -0.080  0.000 -0.080 -0.079 0.000
16          Clostridium_XlVa  0.133  0.000  0.131  0.134 0.000
17 Clostridium_sensu_stricto  0.001  0.000  0.001  0.001 0.000
18           Corynebacterium  0.234  0.000  0.225  0.243 0.000
20               Eggerthella -0.025  0.000 -0.031 -0.018 0.000
21              Enterobacter -0.028  0.000 -0.029 -0.027 0.000
22              Enterococcus  0.019  0.000  0.018  0.019 0.000
23      Escherichia/Shigella  0.005  0.000  0.005  0.005 0.000
24     F__Enterobacteriaceae -0.033  0.000 -0.034 -0.033 0.000
25    F__Erysipelotrichaceae -0.095  0.000 -0.097 -0.092 0.000
26        F__Lachnospiraceae -0.033  0.000 -0.034 -0.033 0.000
28                Finegoldia  0.048  0.000  0.035  0.062 0.000
30                   Gemella -0.078  0.000 -0.084 -0.072 0.000
31            Granulicatella -0.103  0.000 -0.125 -0.080 0.000
32               Haemophilus  0.051  0.000  0.048  0.053 0.000
33           Intestinibacter  0.056  0.000  0.050  0.062 0.000
34                Klebsiella -0.013  0.000 -0.014 -0.012 0.000
35             Lactobacillus  0.032  0.000  0.031  0.033 0.000
36               Lactococcus  0.148  0.000  0.130  0.167 0.000
38           Parabacteroides -0.031  0.000 -0.032 -0.030 0.000
39                Prevotella -0.037  0.000 -0.050 -0.024 0.000
40         Propionibacterium  0.103  0.000  0.095  0.111 0.000
41                Romboutsia  0.232  0.000  0.226  0.238 0.000
42                    Rothia -0.028  0.000 -0.034 -0.023 0.000
43            Staphylococcus  0.031  0.000  0.029  0.032 0.000
44             Streptococcus -0.031  0.000 -0.031 -0.030 0.000
45               Varibaculum  0.144  0.000  0.132  0.156 0.000
46               Veillonella  0.009  0.000  0.008  0.009 0.000
19            Dolosigranulum  0.027  0.037  0.002  0.052 0.041
27          Faecalibacterium -0.013  0.042 -0.025  0.000 0.045
37            Negativicoccus -0.009  0.072 -0.019  0.001 0.075</code></pre>
<p>&lt;&gt;</p>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span> Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 4.1.2 (2021-11-01)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 19043)

Matrix products: default

locale:
[1] LC_COLLATE=English_United States.1252 
[2] LC_CTYPE=English_United States.1252   
[3] LC_MONETARY=English_United States.1252
[4] LC_NUMERIC=C                          
[5] LC_TIME=English_United States.1252    

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] vegan_2.6-2     lattice_0.20-45 permute_0.9-7  

loaded via a namespace (and not attached):
 [1] Rcpp_1.0.9       pillar_1.8.0     compiler_4.1.2   bslib_0.4.0     
 [5] later_1.3.0      jquerylib_0.1.4  git2r_0.30.1     workflowr_1.7.0 
 [9] tools_4.1.2      digest_0.6.29    nlme_3.1-153     jsonlite_1.8.0  
[13] evaluate_0.15    lifecycle_1.0.1  tibble_3.1.7     mgcv_1.8-38     
[17] pkgconfig_2.0.3  rlang_1.0.4      Matrix_1.3-4     cli_3.3.0       
[21] rstudioapi_0.13  parallel_4.1.2   yaml_2.3.5       xfun_0.31       
[25] fastmap_1.1.0    cluster_2.1.2    stringr_1.4.0    knitr_1.39      
[29] fs_1.5.2         vctrs_0.4.1      sass_0.4.2       grid_4.1.2      
[33] rprojroot_2.0.3  glue_1.6.2       R6_2.5.1         fansi_1.0.3     
[37] rmarkdown_2.14   magrittr_2.0.3   whisker_0.4      splines_4.1.2   
[41] MASS_7.3-54      promises_1.2.0.1 ellipsis_0.3.2   htmltools_0.5.2 
[45] httpuv_1.6.5     utf8_1.2.2       stringi_1.7.6    cachem_1.0.6    </code></pre>
</div>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
https://docs.mathjax.org/en/latest/web/configuration.html. This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>





</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
